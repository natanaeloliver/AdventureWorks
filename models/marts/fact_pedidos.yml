version: 2
models:
  - name: fact_pedidos
    description: Tabela fato com os pedidos da Adventure Works.
    columns:
      - name: PK_PEDIDO
        description: Chave primária da fato dos pedidos.
        tests:
          - unique
          - not_null
      
      - name: FK_CLIENTE
        description: Chave estrangeira da dimensão dos clientes
        tests:
          - not_null
          - relationships:
              field: PK_CLIENTE
              to: ref('dim_clientes')

      - name: FK_CARTAO
        description: Chave estrangeira da dimensão dos cartões
        tests:
          - not_null
          - relationships:
              field: PK_CARTAO
              to: ref('dim_cartoes')

      - name: FK_ENDERECO
        description: Chave estrangeira da dimensão dos endereços
        tests:
          - not_null
          - relationships:
              field: PK_ENDERECO
              to: ref('dim_enderecos')

      - name: FK_VENDEDOR
        description: Chave estrangeira da dimensão dos vendedores
        tests:
          - relationships:
              field: PK_VENDEDOR
              to: ref('dim_vendedores')

      - name: CD_TERRITORIO
        description: Código do território

      - name: CD_TRANSPORTADORA
        description: Código da transportadora

      - name: CD_CLIENTE
        description: Código do cliente (loja ou pessoa)

      - name: CD_PESSOA
        description: Código da pessoa (cliente)

      - name: CD_ENDERECO
        description: Código do endereço de entrega

      - name: CD_CARTAO
        description: Código do registro do cartão na empresa

      - name: CD_VENDEDOR
        description: Código do vendedor

      - name: CD_VENDEDOR_ATRIBUIDO
        description: Código do vendedor atribuido ao cliente (representante)

      - name: CD_PEDIDO
        description: Código do pedido

      - name: CHAVE_PESSOA_ENDERECO
        description: Chave da pessoa com o seu respectivo endereço

      - name: CHAVE_CLIENTE_CARTAO
        description: Chave do cliente com o seu cartão de crédito, quando não há cartão no pedido é identificada com um zero

      - name: NUMERO_REVISAO
        description: Número da revisão do pedido

      - name: DT_PEDIDO
        description: Data do pedido

      - name: STATUS_PEDIDO
        description: Situação do pedido

      - name: CD_STATUS_PEDIDO
        description: Código da situação do pedido

      - name: TP_PEDIDO
        description: Tipo de pedido

      - name: CD_TP_PEDIDO
        description: Código do tipo de pedido

      - name: CHECK_SUBTOTAL
        description: Valor para a conferência do valor total do pedido vindo apenas do preço dos itens

      - name: TAXAS_PEDIDO
        description: Taxas do pedido

      - name: FRETE_PEDIDO
        description: Frete do pedido

      - name: CHECK_TOTAL_PEDIDO
        description: Valor para a conferência do valor total do pedido

      - name: NM_TRANSPORTADORA
        description: Nome da transportadora

      - name: FRETE_BASE
        description: Valor base do frete da transportadora

      - name: TAXA_FRETE
        description: Taxa do frete da transportadora
